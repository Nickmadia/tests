import pandas as pd
import matplotlib.pyplot as plt

# Read the CSV file into a DataFrame
df = pd.read_csv("malware.csv")


# Group the data by tool
grouped_by_tool = df.groupby('tool')

# Plotting for each tool
for tool, tool_data in grouped_by_tool:
    # Pivot the data to get malware families as index and number of positives for each tool
    pivot_df = tool_data.pivot_table(index='malware_family', values='positive', aggfunc='sum')
    
    # Plotting
    plt.figure(figsize=(10, 6))
    plt.bar(pivot_df.index, pivot_df['positive'], color='skyblue')
    plt.xlabel('Malware Family')
    plt.ylabel('Number of Positives')
    plt.title(f'Number of Positives by Malware Family for {tool}')
    plt.xticks(rotation=45, ha='right')
    plt.tight_layout()
    plt.savefig(f'positives_by_malware_family_{tool}.png')
# Show plot
